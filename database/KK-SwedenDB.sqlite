DROP TABLE IF EXISTS customers;
CREATE TABLE customers(
    id INT,
    name TEXT,
    address TEXT
);

DROP TABLE IF EXISTS orders;
CREATE TABLE orders(
    id INT,
    latestDeliveryTime TIMESTAMP,
    customerId INT,
    PRIMARY KEY (id),
    FOREIGN KEY (customerId) REFERENCES customers(id)
);

DROP TABLE IF EXISTS recipes;
CREATE TABLE recipes(
    id INT,
    name TEXT,
    PRIMARY KEY (id)
);

DROP TABLE IF EXISTS pallets;
CREATE TABLE pallets(
    id INT,
    amount INT,
    productionDate DATE,
    isBlocked BOOLEAN,
    location TEXT,
    deliveryTime TIMESTAMP,
    recipeId INT,
    orderId INT,
    PRIMARY KEY (id),
    FOREIGN KEY (recipeId) REFERENCES recipes(id),
    FOREIGN KEY (orderId) REFERENCES orders(id)
);

DROP TABLE IF EXISTS rawMaterials;
CREATE TABLE rawMaterials(
    id INT,
    name TEXT,
    amount INT,
    unit TEXT,
    lastDeliveryAmount INT,
    lastDeliveryTime DATE,
    PRIMARY KEY (id)
);

DROP TABLE IF EXISTS recipeIngredients;
CREATE TABLE recipeIngredients(
    recipeId INT,
    rawMaterialId INT,
    amount INT,
    FOREIGN KEY (recipeId) REFERENCES recipes(id),
    FOREIGN KEY (rawMaterialId) REFERENCES rawMaterials(id),
    PRIMARY KEY (recipeId, rawMaterialId)
);

DROP TABLE IF EXISTS orderRecipeAmount;
CREATE TABLE orderRecipeAmount(
    orderId INT,
    recipeId INT,
    amount INT,
    FOREIGN KEY (orderId) REFERENCES orders(id),
    FOREIGN KEY (recipeId) REFERENCES recipes(id),
    PRIMARY KEY (orderId, recipeId)
);